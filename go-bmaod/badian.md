## go 语言笔试面试宝典

1、数组和切片有什么不同？

首先 slice地底层是数组，slice是对数组的封装，它描述了一个数组的片段
这二者都可以使用下标来访问元素
数组是定长的，数组的长度是数组类型的一部分，切片是不定长的，切片可以动态的扩容
数组是一片地址连续的内存，slice本质是一个结构体，内部维护了三个字段

```go
// runtime/slice.go
type slice strcut{
    array unsafe.Pointer // 元素指针 指向底层数组
    len int  // 长度 数组的长度，所谓的长度就是元素的个数
    cap int  // 容量 底层数组的容量
}
```

底层数组可以被多个slice同时指向，因此对一个slice的元素进行操作是有可能影响其他slice的

2、切片是怎么扩容的？

一般向切片追加元素，会引起切片的扩容操作
当索引len-1所指向的元素已经是底层数组最后一个元素的时候，就没法再添加了

这时候，slice会移动到新的内存位置，新底层数组的长度会增加，这样就可以放置新增的元素
同时为了应对可能再次发生的追加操作，新的底层数组的长度预留了一些buffer

新的buffer预留有一定的规律
在1.18之前，这个规律是

> 当原 slice 容量小于 1024 的时候，新 slice 容量变成原来的 2 倍；原 slice 容量超过 1024，新 slice 容量变成原来的1.25倍

在1.18之后，这个规律变为了：
> 当原slice容量(oldcap)小于256的时候，新slice(newcap)容量为原来的2倍；原来slice容量超过256，新slice容量newcap=oldcap+(oldcap+3*256)/4